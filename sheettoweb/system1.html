<!DOCTYPE html>
<html lang="ne">
<header class="topbar hidden" id="topbar">
  <div class="title">рд╕рд╣рдХрд╛рд░реА рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди рдкреНрд░рдгрд╛рд▓реА</div>

  <div class="profile" onclick="toggleProfile()">
    <img id="ppTop" src="https://via.placeholder.com/40">

    <div class="dropdown" id="profileMenu">
      <div onclick="openProfile()">ЁЯСд Profile</div>
      <div onclick="show('pwBox')">ЁЯФС Change Password</div>
      <div onclick="logout()">ЁЯЪк Logout</div>
    </div>
  </div>
</header>


  <style>
.hidden{
  display:none !important;
}
</style>
  <style>
  /* MEMBER LOGIN рд╣реБрдБрджрд╛ hide */
.member-role .admin,
.member-role .staff{
  display:none !important;
}
</style>
  <style>
  .topbar{
  display:flex;
  justify-content:space-between;
  align-items:center;
  background:#0d6efd;
  color:#fff;
  padding:10px 15px;
}

.profile{
  position:relative;
  cursor:pointer;
}

.profile img{
  width:40px;
  height:40px;
  border-radius:50%;
  border:2px solid #fff;
}

.dropdown{
  display:none;
  position:absolute;
  right:0;
  top:50px;
  background:#fff;
  color:#000;
  border-radius:6px;
  box-shadow:0 2px 8px rgba(0,0,0,.2);
  min-width:160px;
  z-index:1000;
}

.dropdown div{
  padding:10px;
  border-bottom:1px solid #eee;
}

.dropdown div:hover{
  background:#f1f1f1;
}

</style>

<body>
<header>рд╕рд╣рдХрд╛рд░реА рд╡реНрдпрд╡рд╕реНрдерд╛рдкрди рдкреНрд░рдгрд╛рд▓реА</header>

<!-- LOGIN -->
<div class="container" id="loginBox">
  <div class="card">
    <h3>Login</h3>
    <input id="lu" placeholder="Username">
    <input id="lp" type="password" placeholder="Password">
    <button onclick="login()">Login</button>
  </div>
</div>


<!-- DASHBOARD -->
<div class="container hidden" id="dash">

  <!-- PROFILE -->
  <div class="card hidden" id="profileBox">
  <h3>My Profile</h3>

  <img id="bigPhoto" width="100"><br><br>

  <input type="file" id="photoFile" accept="image/*">
  <button onclick="uploadPhoto()">ЁЯУ╖ Upload Photo</button>

  <div id="profileInfo"></div>
</div>

<div class="card hidden" id="pwBox">
  <h3>Change Password</h3>
  <input type="password" id="oldpw" placeholder="Old Password">
  <input type="password" id="newpw" placeholder="New Password">
  <button onclick="changePw()">Change</button>
</div>


  <!-- NAV -->
  <div class="card nav">
    <button onclick="show('memberListBox')" class="admin staff">Members List</button>
    <button onclick="show('memberBox')" class="admin staff">Member</button>
    <button onclick="show('txnBox')" class="admin staff">Savings / Withdraw</button>
    <button onclick="show('transferBox')" class="admin staff member">Transfer</button>
    <button onclick="show('stockBox')" class="admin staff">Stock</button>
    <button onclick="show('reportBox')" class="admin">All Transactions</button>
    <button onclick="show('myBox')" class="member">My Account</button>
  </div>

  <!-- ADD MEMBER -->
  <div class="card hidden" id="memberListBox">
  <h3>ЁЯФН рд╕рджрд╕реНрдп рдЦреЛрдЬреНрдиреБрд╣реЛрд╕реН</h3>

  <input id="searchKey" placeholder="рдирд╛рдо / рдореЛрдмрд╛рдЗрд▓ / Member ID">
  <button onclick="searchMembers()">Search</button>

  <table id="memberTable"></table>
</div>

  <div class="card" id="memberBox">
<h3>ЁЯз╛ рд╕рджрд╕реНрдп рджрд░реНрддрд╛ рдлрд╛рд░рдо (рд╕рд╣рдХрд╛рд░реА рдРрди рдЕрдиреБрд╕рд╛рд░)</h3>

<h4>резя╕ПтГг рд╡реНрдпрдХреНрддрд┐рдЧрдд рд╡рд┐рд╡рд░рдг</h4>
<input id="m_name" placeholder="рдкреВрд░рд╛ рдирд╛рдо (рдиреЗрдкрд╛рд▓реАрдорд╛)" required>

<input id="m_dob" type="date">
<select id="m_gender">
  <option value="">рд▓рд┐рдЩреНрдЧ рдЫрд╛рдиреНрдиреБрд╣реЛрд╕реН</option>
  <option>рдкреБрд░реБрд╖</option>
  <option>рдорд╣рд┐рд▓рд╛</option>
  <option>рдЕрдиреНрдп</option>
</select>

<input id="m_father" placeholder="рдмреБрд╡рд╛рдХреЛ рдирд╛рдо">
<input id="m_mother" placeholder="рдЖрдорд╛рдХреЛ рдирд╛рдо">
<input id="m_spouse" placeholder="рдкрддрд┐ / рдкрддреНрдиреАрдХреЛ рдирд╛рдо">

<input id="m_profession" placeholder="рдкреЗрд╢рд╛">

<h4>реия╕ПтГг рд╕реНрдерд╛рдпреА рдареЗрдЧрд╛рдирд╛</h4>
<input id="m_province" placeholder="рдкреНрд░рджреЗрд╢">
<input id="m_district" placeholder="рдЬрд┐рд▓реНрд▓рд╛">
<input id="m_palika" placeholder="рдкрд╛рд▓рд┐рдХрд╛">
<input id="m_ward" placeholder="рд╡рдбрд╛ рдирдВ">

<h4>рейя╕ПтГг рд╕рдореНрдкрд░реНрдХ рд╡рд┐рд╡рд░рдг</h4>
<input id="m_phone" placeholder="рдореЛрдмрд╛рдЗрд▓ рдирдВ" required>
<input id="m_email" placeholder="Email (рдпрджрд┐ рдЫ рднрдиреЗ)">

<h4>рекя╕ПтГг рдирд╛рдЧрд░рд┐рдХрддрд╛ рд╡рд┐рд╡рд░рдг</h4>
<input id="m_ctz_no" placeholder="рдирд╛рдЧрд░рд┐рдХрддрд╛ рдирдВ" required>
<input id="m_ctz_dist" placeholder="рдЬрд╛рд░реА рдЬрд┐рд▓реНрд▓рд╛">
<input id="m_ctz_date" type="date">

<label>ЁЯУ╖ рдирд╛рдЧрд░рд┐рдХрддрд╛ рдлреЛрдЯреЛ (рдЕрдЧрд╛рдбрд┐/рдкрдЫрд╛рдбрд┐)</label>
<input type="file" id="m_ctz_img" accept="image/*" required>
<button onclick="uploadCitizenship()">ЁЯУ╖ рдирд╛рдЧрд░рд┐рдХрддрд╛ Upload</button>


<h4>реля╕ПтГг рд╕рджрд╕реНрдп рдлреЛрдЯреЛ</h4>
<input type="file" id="m_photo" accept="image/*" required>
<button onclick="uploadMemberPhoto()">ЁЯУ╖ рд╕рджрд╕реНрдп рдлреЛрдЯреЛ Upload</button>


<h4>ремя╕ПтГг рд╢реЗрдпрд░ рд╡рд┐рд╡рд░рдг</h4>
<input id="m_share_qty" type="number" placeholder="рд╢реЗрдпрд░ рд╕рдВрдЦреНрдпрд╛">
<input id="m_share_amt" type="number" placeholder="рд╢реЗрдпрд░ рд░рдХрдо">
<input id="m_join_date" type="date">

<select id="m_type">
  <option value="">рд╕рджрд╕реНрдп рдкреНрд░рдХрд╛рд░</option>
  <option>рд╕рд╛рдзрд╛рд░рдг</option>
  <option>рд╕рдВрд╕реНрдерд╛рдЧрдд</option>
</select>

<h4>реня╕ПтГг Nominee (рд╣рдХрд╡рд╛рд▓рд╛)</h4>
<input id="n_name" placeholder="рд╣рдХрд╡рд╛рд▓рд╛рдХреЛ рдирд╛рдо" required>
<input id="n_relation" placeholder="рдирд╛рддрд╛">
<input id="n_phone" placeholder="рдлреЛрди">
<input id="n_ctz" placeholder="рдирд╛рдЧрд░рд┐рдХрддрд╛ рдирдВ">

<h4>реоя╕ПтГг рдШреЛрд╖рдгрд╛</h4>
<label>
<input type="checkbox" required>
рдо рд╕рд╣рдХрд╛рд░реАрдХреЛ рдирд┐рдпрдо, рдРрди рддрдерд╛ рд╡рд┐рдзрд╛рди рдкрд╛рд▓рдирд╛ рдЧрд░реНрдиреЗ рдШреЛрд╖рдгрд╛ рдЧрд░реНрджрдЫреБред
</label>

<br><br>
<button onclick="addMember()">тЬЕ рд╕рджрд╕реНрдп рджрд░реНрддрд╛ рдЧрд░реНрдиреБрд╣реЛрд╕реН</button>
</div>



  <!-- SAVINGS / WITHDRAW -->
  <div class="card hidden" id="txnBox">
    <h3>Savings / Withdraw</h3>
    <input id="tmember" placeholder="Member ID">
    <input id="tamt" type="number" placeholder="Amount">
    <button onclick="savings()">Savings</button>
    <button class="danger" onclick="withdraw()">Withdraw</button>
  </div>

  <!-- TRANSFER -->
  <div class="card hidden" id="transferBox">
    <h3>Member Transfer</h3>
    <input id="from" placeholder="From Member ID">
    <input id="to" placeholder="To Member ID">
    <input id="tamt2" type="number" placeholder="Amount">
    <button onclick="memberTransfer()">Transfer</button>
  </div>

  <!-- STOCK -->
  <div class="card hidden" id="stockBox">
    <h3>Stock Sell</h3>
    <input id="sid" placeholder="Item ID">
    <input id="smember" placeholder="Member ID">
    <input id="sqty" type="number" placeholder="Qty">
    <button onclick="sellStock()">Sell</button>
  </div>

  <!-- MEMBER SELF -->
  <div class="card hidden" id="myBox">
  <h3>рдореЗрд░реЛ рд╡рд┐рд╡рд░рдг</h3>

  <label>рдирд╛рдо</label>
  <input id="myName">

  <label>рдлреЛрди</label>
  <input id="myPhone">

  <label>Email</label>
  <input id="myEmail">

  <button onclick="updateMyProfile()">ЁЯТ╛ Save</button>

  <hr>

  <h4>рдореЗрд░реЛ рдХрд╛рд░реЛрдмрд╛рд░</h4>
  <table id="myTx"></table>
</div>


  <!-- ADMIN REPORT -->
   <div class="card" id="chartBox">
  <h3>Dashboard Summary</h3>
  <canvas id="txChart"></canvas>
  <canvas id="loanChart"></canvas>
</div>
  <div class="card hidden" id="reportBox">
    <h3>All Transactions</h3>
    <table id="allTx"></table>
  </div>

</div>
 

<script>
let MEMBER_PHOTO_URL = "";
let CTZ_PHOTO_URL = "";
</script>
<script>
/******** CONFIG ********/
const IMGBB_KEY = "f5d95811959fdcd59c8ea459aadb650b";
const API = "https://script.google.com/macros/s/AKfycbwWu8Y3TveduJ9_So6bYLjA1yPVoOru6x3O2XORRO7a3X3yZkzTMgMOTp81GCUwMIf20A/exec";
const KEY = "sarojkumar643";

/******** LOGIN ********/
function login(){
 fetch(API,{
  method:"POST",
  body:JSON.stringify({
    apiKey:KEY,
    action:"login",
    username:lu.value.trim(),
    password:lp.value.trim(),
    agent:navigator.userAgent,
    ip:"WEB"
  })
 })
 .then(r=>r.json())
 .then(j=>{
  if(!j.success) return alert(j.msg); // ЁЯФе FIX HERE

  sessionStorage.setItem("user", j.username);
  sessionStorage.setItem("role", j.role);
  sessionStorage.setItem("mid", j.member_id || "");
  sessionStorage.setItem("photo", j.photo || "");

  loginBox.classList.add("hidden");
  dash.classList.remove("hidden");
  topbar.classList.remove("hidden");

  document.getElementById("ppTop").src  = j.photo || "https://via.placeholder.com/40";
  document.getElementById("bigPhoto").src = j.photo || "";

  roleUI(j.role);
  loadCharts();
 })
 .catch(err=>{
  alert("Server error");
  console.error(err);
 });
}


/******** ROLE UI ********/
function roleUI(role){
  document.body.classList.remove("admin-role","staff-role","member-role");

  if(role === "admin") document.body.classList.add("admin-role");
  if(role === "staff") document.body.classList.add("staff-role");
  if(role === "member") document.body.classList.add("member-role");
}


/******** NAV ********/
function show(id){
 document.querySelectorAll("#dash .card").forEach(c=>{
  if(c.id && c.id!=="") c.classList.add("hidden");
 });
 document.getElementById(id).classList.remove("hidden");

 if(id=="myBox") loadMy();
 if(id=="reportBox") loadAllTx();
 if(id==="profileBox") loadProfile();

}

/******** API HELPERS ********/
function post(o){
 return fetch(API,{method:"POST",body:JSON.stringify(o)})
  .then(r=>r.json());
}

/******** ACTIONS ********/
function addMember(){
  post({
    apiKey:KEY,
    action: EDIT_MEMBER_ID ? "updateMember" : "addMember",
    member: EDIT_MEMBER_ID || "",

    name:m_name.value,
    dob:m_dob.value,
    gender:m_gender.value,

    father:m_father.value,
    mother:m_mother.value,
    spouse:m_spouse.value,
    profession:m_profession.value,

    province:m_province.value,
    district:m_district.value,
    palika:m_palika.value,
    ward:m_ward.value,

    phone:m_phone.value,
    email:m_email.value,

    ctz_no:m_ctz_no.value,
    ctz_dist:m_ctz_dist.value,
    ctz_date:m_ctz_date.value,
    ctz_img:CTZ_PHOTO_URL,
    photo:MEMBER_PHOTO_URL,

    share_qty:m_share_qty.value,
    share_amount:m_share_amt.value,
    join_date:m_join_date.value,
    member_type:m_type.value,

    nominee_name:n_name.value,
    nominee_relation:n_relation.value,
    nominee_phone:n_phone.value,
    nominee_citizenship:n_ctz.value
  }).then(r=>{
    alert("Saved");
    EDIT_MEMBER_ID = "";   // ЁЯФе important
  });
}

function deleteMember(mid){
  if(!confirm("Delete this member?")) return;

  post({
    apiKey:KEY,
    action:"deleteMember",
    member:mid
  }).then(r=>{
    alert("Deleted");
    searchMembers();
  });
}
function editMember(mid){
  post({
    apiKey:KEY,
    action:"getMember",
    member:mid
  }).then(m=>{
    show("memberBox");

    m_name.value = m.name;
    m_dob.value = m.dob;
    m_gender.value = m.gender;

    m_father.value = m.father;
    m_mother.value = m.mother;
    m_spouse.value = m.spouse;
    m_profession.value = m.profession;

    m_province.value = m.province;
    m_district.value = m.district;
    m_palika.value = m.palika;
    m_ward.value = m.ward;

    m_phone.value = m.phone;
    m_email.value = m.email;

    m_ctz_no.value = m.citizenship_no;
    m_ctz_dist.value = m.citizenship_dist;
    m_ctz_date.value = m.citizenship_date;

    m_share_qty.value = m.share_qty;
    m_share_amt.value = m.share_amount;
    m_join_date.value = m.join_date;
    m_type.value = m.member_type;

    n_name.value = m.nominee_name;
    n_relation.value = m.nominee_relation;
    n_phone.value = m.nominee_phone;
    n_ctz.value = m.nominee_citizenship;

    MEMBER_PHOTO_URL = m.photo;
    CTZ_PHOTO_URL = m.citizenship_img;

    EDIT_MEMBER_ID = mid;   // ЁЯФе THIS LINE
  });
}


function savings(){
 post({apiKey:KEY,action:"savings",
  member:tmember.value,amount:+tamt.value,
  by:sessionStorage.getItem("user")
 }).then(r=>alert(r.success?"Done":r.error));
}

function withdraw(){
 post({apiKey:KEY,action:"withdraw",
  member:tmember.value,amount:+tamt.value,
  by:sessionStorage.getItem("user")
 }).then(r=>alert(r.success?"Done":r.error));
}

function memberTransfer(){
 post({apiKey:KEY,action:"memberTransfer",
  from:from.value,to:to.value,
  amount:+tamt2.value,
  by:sessionStorage.getItem("user")
 }).then(r=>alert(r.success?"Done":r.error));
}

function sellStock(){
 post({apiKey:KEY,action:"sellStock",
  item:sid.value,member:smember.value,
  qty:+sqty.value,by:sessionStorage.getItem("user")
 }).then(r=>alert(r.success?"Sold":r.error));
}

/******** MEMBER VIEW ********/
function loadMy(){

  // ЁЯФ╣ bio load
  post({
    apiKey:KEY,
    action:"getMember",
    member:sessionStorage.getItem("mid")
  }).then(m=>{
    myName.value  = m.name;
    myPhone.value = m.phone;
    myEmail.value = m.email;
  });

  // ЁЯФ╣ transaction load
  post({
    apiKey:KEY,
    action:"memberTx",
    member:sessionStorage.getItem("mid")
  }).then(d=>{
    let h="<tr><th>Date</th><th>Type</th><th>Amt</th></tr>";
    d.slice(1).forEach(r=>{
      h+=`<tr>
        <td>${new Date(r[1]).toLocaleDateString()}</td>
        <td>${r[2]}</td>
        <td>${r[5]}</td>
      </tr>`;
    });
    myTx.innerHTML=h;
  });
}

  function updateMyProfile(){
  post({
    apiKey:KEY,
    action:"updateMember",
    member:sessionStorage.getItem("mid"),
    name:myName.value,
    phone:myPhone.value,
    email:myEmail.value
  }).then(r=>{
    alert(r.success ? "Profile Update рднрдпреЛ" : r.error);
  });
}

/******** ADMIN REPORT ********/
function loadAllTx(){
 post({apiKey:KEY,action:"allTx"})
 .then(d=>{
  let h="<tr><th>Date</th><th>Type</th><th>From</th><th>To</th><th>Amt</th></tr>";
  d.slice(1).forEach(r=>{
    h+=`<tr><td>${new Date(r[1]).toLocaleDateString()}</td><td>${r[2]}</td><td>${r[3]}</td><td>${r[4]}</td><td>${r[5]}</td></tr>`;
  });
  allTx.innerHTML=h;
 });
}

/******** LOGOUT ********/
function logout(){
 post({apiKey:KEY,action:"logout",
  username:sessionStorage.getItem("user")
 }).then(()=>{
  sessionStorage.clear();
  location.reload();
   topbar.classList.add("hidden");
dash.classList.add("hidden");
loginBox.classList.remove("hidden");

 });
}

  function loadCharts(){
 post({apiKey:KEY,action:"allTx"}).then(d=>{
  let sav=0,wit=0,trs=0;
  d.slice(1).forEach(r=>{
    if(r[2]=="SAVINGS") sav+=+r[5];
    if(r[2]=="WITHDRAW") wit+=+r[5];
    if(r[2]=="TRANSFER") trs+=+r[5];
  });

  new Chart(txChart,{
    type:"pie",
    data:{
      labels:["Savings","Withdraw","Transfer"],
      datasets:[{data:[sav,wit,trs]}]
    }
  });
 });

 fetch(API,{method:"POST",body:JSON.stringify({
  apiKey:KEY,action:"memberLoan",
  member:sessionStorage.getItem("mid")
 })}).then(r=>r.json()).then(d=>{
  let labels=[],bal=[];
  d.schedule.slice(1).forEach(r=>{
    labels.push("M"+r[1]);
    bal.push(r[6]);
  });

  new Chart(loanChart,{
    type:"line",
    data:{
      labels:labels,
      datasets:[{label:"Loan Balance",data:bal,fill:false}]
    }
  });
 });
}
  function changePw(){
  post({
    apiKey:KEY,
    action:"changePassword",
    username:sessionStorage.getItem("user"),
    oldPassword:oldpw.value,
    newPassword:newpw.value
  }).then(r=>{
    if(r.success){
      alert("Password changed successfully");
      oldpw.value="";
      newpw.value="";
    }else{
      alert(r.error);
    }
  });
}

  function toggleProfile(){
  profileMenu.style.display =
    profileMenu.style.display === "block" ? "none" : "block";
}

document.addEventListener("click",e=>{
  if(!e.target.closest(".profile")){
    profileMenu.style.display="none";
  }
});

  function loadProfile(){
  bigPhoto.src = sessionStorage.getItem("photo") || "";
  profileInfo.innerHTML = `
    <b>${sessionStorage.getItem("user")}</b><br>
    Role: ${sessionStorage.getItem("role")}<br>
    Member ID: ${sessionStorage.getItem("mid")}
  `;
}
function updatePhoto(){
  const url = newPhoto.value;

  post({
    apiKey:KEY,
    action:"updatePhoto",
    username:sessionStorage.getItem("user"),
    photo:url
  }).then(r=>{
    if(r.success){
      alert("Photo updated");

      // тЬЕ session update
      sessionStorage.setItem("photo", url);

      // тЬЕ top bar photo
      document.getElementById("ppTop").src = url;

      // тЬЕ profile big photo
      document.getElementById("bigPhoto").src = url;

    }else{
      alert(r.error);
    }
  });
}

function uploadPhoto(){
  const file = document.getElementById("photoFile").files[0];
  if(!file) return alert("рдлреЛрдЯреЛ рдЫрд╛рдиреНрдиреБрд╣реЛрд╕реН");

  const fd = new FormData();
  fd.append("image", file);

  fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`,{
    method:"POST",
    body:fd
  })
  .then(r=>r.json())
  .then(res=>{
    if(!res.success) return alert("Upload рдЕрд╕рдлрд▓");

    const photoUrl = res.data.url;
    updatePhotoToSystem(photoUrl);
  });
}
function updatePhotoToSystem(url){
  post({
    apiKey:KEY,
    action:"updatePhoto",
    username:sessionStorage.getItem("user"),
    photo:url
  }).then(r=>{
    if(r.success){

      sessionStorage.setItem("photo", url);

      // ЁЯФЭ Top bar
      document.getElementById("ppTop").src = url;


      // ЁЯСд Profile page
      document.getElementById("bigPhoto").src = url;

      alert("Photo рд╕рдлрд▓рддрд╛рдкреВрд░реНрд╡рдХ update рднрдпреЛ");
    }else{
      alert(r.error);
    }
  });
}

  function openProfile(){
  // рд╕рдмреИ dashboard card hide
  document.querySelectorAll("#dash .card").forEach(c=>{
    c.classList.add("hidden");
  });

  // profile рдорд╛рддреНрд░ show
  document.getElementById("profileBox").classList.remove("hidden");
  loadProfile();
}
  
function uploadCitizenship(){
  const file = m_ctz_img.files[0];
  if(!file) return alert("рдирд╛рдЧрд░рд┐рдХрддрд╛ рдлреЛрдЯреЛ рдЫрд╛рдиреНрдиреБрд╣реЛрд╕реН");

  const fd = new FormData();
  fd.append("image", file);

  fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`,{
    method:"POST",
    body:fd
  })
  .then(r=>r.json())
  .then(res=>{
    if(res.success){
      CTZ_PHOTO_URL = res.data.url;
      alert("рдирд╛рдЧрд░рд┐рдХрддрд╛ рдлреЛрдЯреЛ upload рднрдпреЛ");
    }
  });
}

  function uploadMemberPhoto(){
  const file = m_photo.files[0];
  if(!file) return alert("рд╕рджрд╕реНрдп рдлреЛрдЯреЛ рдЫрд╛рдиреНрдиреБрд╣реЛрд╕реН");

  const fd = new FormData();
  fd.append("image", file);

  fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`,{
    method:"POST",
    body:fd
  })
  .then(r=>r.json())
  .then(res=>{
    if(res.success){
      MEMBER_PHOTO_URL = res.data.url;
      alert("рд╕рджрд╕реНрдп рдлреЛрдЯреЛ upload рднрдпреЛ");
    }
  });
}

  function searchMembers(){
  post({
    apiKey:KEY,
    action:"searchMembers",
    key:searchKey.value
  }).then(d=>{
    let h = `
      <tr>
        <th>ID</th><th>рдирд╛рдо</th><th>рдлреЛрди</th>
        <th>Action</th>
      </tr>`;
    d.forEach(m=>{
      h += `
      <tr>
        <td>${m.id}</td>
        <td>${m.name}</td>
        <td>${m.phone}</td>
        <td>
          <button onclick="editMember('${m.id}')">тЬПя╕П Edit</button>
          <button onclick="deleteMember('${m.id}')">ЁЯЧС Delete</button>
        </td>
      </tr>`;
    });
    memberTable.innerHTML = h;
  });
}


 if(!sessionStorage.getItem("user")){
  topbar.classList.add("hidden");
  dash.classList.add("hidden");
  loginBox.classList.remove("hidden");
}
</script>
  <script>
/******** INITIAL UI STATE ********/
window.onload = function(){

  // login рдЫреИрди рднрдиреЗ
  if(!sessionStorage.getItem("user")){

    // topbar hide
    document.getElementById("topbar").classList.add("hidden");

    // dashboard hide
    document.getElementById("dash").classList.add("hidden");

    // login box show
    document.getElementById("loginBox").classList.remove("hidden");

    // dashboard рднрд┐рддреНрд░рдХрд╛ рд╕рдмреИ card hide
    document.querySelectorAll("#dash .card").forEach(c=>{
      c.classList.add("hidden");
    });
  }
}
</script>

</body>
</html>
