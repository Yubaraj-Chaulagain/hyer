<!DOCTYPE html>
<html>
<head>
  <base target="_top">
  <style>
    body { font-family: Arial; max-width: 900px; margin: auto; }
    label { font-weight: bold; margin-top: 10px; display: block; }
    input, select, textarea { width: 100%; padding: 6px; }
    h3 { background:#eee; padding:6px; }
  </style>
</head>
<body>

<h3>Member Registration Form</h3>

<label>Member ID</label>
<input id="MemberID" placeholder="M001" required>

<label>Full Name</label>
<input id="FullName">

<label>Father Name</label>
<input id="FatherName">

<label>Husband / Wife Name</label>
<input id="HusbandWifeName">

<label>Grandfather Name</label>
<input id="GrandfatherName">

<label>Date of Birth</label>
<input type="date" id="DOB">

<label>Gender</label>
<select id="Gender">
  <option>Male</option>
  <option>Female</option>
  <option>Other</option>
</select>

<label>Marital Status</label>
<select id="MaritalStatus">
  <option>Single</option>
  <option>Married</option>
  <option>Widowed</option>
</select>

<label>Citizenship No</label>
<input id="CitizenshipNo">

<label>Citizenship District</label>
<select id="CitizenshipDistrict">
  <option value="">Select District</option>
</select>


<label>Citizenship Issue Date</label>
<input type="date" id="CitizenshipIssueDate">

<label>Nationality</label>
<input id="Nationality" value="Nepali">

<h3>Address</h3>

<label>Province</label>
<select id="Province"></select>

<label>District</label>
<select id="District"></select>

<label>Municipality</label>
<select id="Municipality"></select>

<label>Ward No</label>
<select id="WardNo"></select>

<label>Permanent Address</label>
<input id="PermanentAddress">

<h3>Contact</h3>

<label>Mobile</label>
<input id="Mobile">

<label>Email</label>
<input id="Email">

<h3>Membership</h3>

<label>Membership Type</label>
<select id="MembershipType">
  <option>General</option>
  <option>Saving</option>
  <option>Loan</option>
</select>

<label>Join Date</label>
<input type="date" id="JoinDate">

<label>Share Qty</label>
<input type="number" id="ShareQty">

<label>Share Amount</label>
<input type="number" id="ShareAmount">

<label>Membership Fee</label>
<input type="number" id="MembershipFee">

<label>Member Status</label>
<select id="MemberStatus">
  <option>Active</option>
  <option>Inactive</option>
</select>

<h3>Nominee</h3>

<label>Nominee Name</label>
<input id="NomineeName">

<label>Nominee Relation</label>
<select id="NomineeRelation">
  <option>Father</option>
  <option>Mother</option>
  <option>Spouse</option>
  <option>Son</option>
  <option>Daughter</option>
</select>

<label>Nominee Citizenship</label>
<input id="NomineeCitizenship">

<label>Nominee Phone</label>
<input id="NomineePhone">

<label>Nominee Address</label>
<input id="NomineeAddress">

<h3>Uploads (IMGBB)</h3>

<label>Photo</label>
<input type="file" onchange="upload(this,'PhotoURL')">
<input id="PhotoURL">

<label>Citizenship File</label>
<input type="file" onchange="upload(this,'CitizenshipFileURL')">
<input id="CitizenshipFileURL">

<label>Signature</label>
<input type="file" onchange="upload(this,'SignatureURL')">
<input id="SignatureURL">

<h3>Other</h3>

<label>Occupation</label>
<select id="Occupation">
  <option>Business</option>
  <option>Service</option>
  <option>Agriculture</option>
  <option>Foreign Employment</option>
</select>

<label>Income Source</label>
<input id="IncomeSource">

<label>Role</label>
<select id="Role">
  <option>Member</option>
  <option>Staff</option>
  <option>Admin</option>
</select>

<label>Remarks</label>
<textarea id="Remarks"></textarea>

<button onclick="submitForm()">Submit</button>

<script>
const ADMIN_URL = "https://fulkumari.com.np/sheettoweb/nepal-admin-structure.json";
const IMGBB_KEY = "f5d95811959fdcd59c8ea459aadb650b"; // replace
let adminData = {};

fetch(ADMIN_URL)
  .then(res => res.json())
  .then(data => {
    adminData = data;
    Province.innerHTML = `<option value="">Select Province</option>`;
    Object.keys(adminData).forEach(p =>
      Province.innerHTML += `<option value="${p}">${p}</option>`
    );
  });

Province.onchange = () => {
  District.innerHTML = `<option value="">Select District</option>`;
  CitizenshipDistrict.innerHTML = `<option value="">Select District</option>`;
  Municipality.innerHTML = `<option value="">Select Municipality</option>`;

  Object.keys(adminData[Province.value]).forEach(d => {
    District.innerHTML += `<option value="${d}">${d}</option>`;
    CitizenshipDistrict.innerHTML += `<option value="${d}">${d}</option>`;
  });
};

District.onchange = () => {
  Municipality.innerHTML = `<option value="">Select Municipality</option>`;
  adminData[Province.value][District.value].forEach(m =>
    Municipality.innerHTML += `<option value="${m}">${m}</option>`
  );
};

// Ward
for (let i = 1; i <= 35; i++) {
  WardNo.innerHTML += `<option value="${i}">${i}</option>`;

function upload(input,target){
  const r=new FileReader();
  r.onloadend=()=>{
    fetch(`https://api.imgbb.com/1/upload?key=${IMGBB_KEY}`,{
      method:'POST',
      body:new URLSearchParams({image:r.result.split(',')[1]})
    }).then(r=>r.json()).then(d=>document.getElementById(target).value=d.data.url);
  };
  r.readAsDataURL(input.files[0]);
}

function submitForm(){
  const data={};
  document.querySelectorAll("input,select,textarea").forEach(e=>data[e.id]=e.value);
  data.Username=data.MemberID;
  data.Password=data.Mobile;
  google.script.run.saveMember(data);
}
</script>

</body>
</html>
