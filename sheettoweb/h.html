<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>सहकारी सदस्य दर्ता फारम</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

<style>
  body{background:#f4f6f8}
  h6{border-bottom:2px solid #e5e7eb;padding-bottom:4px}
</style>
</head>

<body>
<div class="container my-4">
<div class="card shadow">
<div class="card-header bg-success text-white text-center">
  <h4 class="mb-0">सहकारी सदस्य दर्ता फारम</h4>
</div>

<div class="card-body">
<form id="memberForm">

<!-- ================== 1. PERSONAL ================== -->
<h6 class="text-primary">१. व्यक्तिगत विवरण</h6>
<div class="row mb-3">
  <div class="col-md-2">
    <label>सदस्य नं.</label>
    <input class="form-control" name="member_no">
  </div>
  <div class="col-md-3">
    <label>खाता नं.</label>
    <input class="form-control" id="member_id" name="member_ac" required>
  </div>
  <div class="col-md-7">
    <label>पूरा नाम</label>
    <input class="form-control" name="full_name" required>
  </div>
</div>

<div class="row mb-3">
  <div class="col-md-4"><label>बुबाको नाम</label><input class="form-control" name="father_name"></div>
  <div class="col-md-4"><label>हजुर बुबाको नाम</label><input class="form-control" name="grandfather_name"></div>
  <div class="col-md-4"><label>पति / पत्नी</label><input class="form-control" name="spouse_name"></div>
</div>

<div class="row mb-3">
  <div class="col-md-4">
    <label>लिङ्ग</label>
    <select class="form-select" name="gender">
      <option>पुरुष</option><option>महिला</option><option>अन्य</option>
    </select>
  </div>
  <div class="col-md-4"><label>जन्म मिति</label><input type="date" class="form-control" name="dob"></div>
  <div class="col-md-4"><label>नागरिकता नं.</label><input class="form-control" name="citizenship_no"></div>
</div>

<!-- ================== 2. ADDRESS ================== -->
<h6 class="text-primary mt-4">२. ठेगाना</h6>
<div class="row mb-3">
  <div class="col-md-3"><label>प्रदेश</label><select id="province" class="form-select"></select></div>
  <div class="col-md-3"><label>जिल्ला</label><select id="district" class="form-select"></select></div>
  <div class="col-md-3"><label>पालिका</label><select id="municipality" class="form-select"></select></div>
  <div class="col-md-3"><label>वडा नं.</label><input class="form-control" name="ward"></div>
</div>

<!-- ================== 3. CONTACT ================== -->
<h6 class="text-primary mt-4">३. सम्पर्क विवरण</h6>
<div class="row mb-3">
  <div class="col-md-6"><label>मोबाइल नं.</label><input class="form-control" name="member_mobile"></div>
  <div class="col-md-6"><label>ईमेल</label><input type="email" class="form-control" name="member_email"></div>
</div>

<!-- ================== 4. MEMBER TYPE ================== -->
<h6 class="text-primary mt-4">४. सदस्यको प्रकार</h6>
<div class="row mb-3">
  <div class="col-md-4">
    <label>सदस्य प्रकार</label>
    <select class="form-select" name="member_type">
      <option>साधारण सदस्य</option>
      <option>संस्थापक सदस्य</option>
      <option>ऋणी सदस्य</option>
      <option>बाल सदस्य</option>
    </select>
  </div>
  <div class="col-md-4"><label>सेयर संख्या</label><input type="number" class="form-control" name="share_count"></div>
  <div class="col-md-4">
    <label>सदस्य स्थिति</label>
    <select class="form-select" name="member_status">
      <option>सक्रिय</option><option>निष्क्रिय</option>
    </select>
  </div>
</div>

<!-- ================== 5. OCCUPATION ================== -->
<h6 class="text-primary mt-4">५. पेशा तथा आम्दानी</h6>
<div class="row mb-3">
  <div class="col-md-6">
    <label>पेशा</label>
    <select class="form-select" name="occupation">
      <option>कृषि</option><option>व्यवसाय</option><option>सेवा</option>
      <option>वैदेशिक रोजगारी</option><option>मजदुरी</option>
    </select>
  </div>
  <div class="col-md-6"><label>वार्षिक आम्दानी</label><input type="number" class="form-control" name="annual_income"></div>
</div>

<!-- ================== 6. NOMINEE ================== -->
<h6 class="text-primary mt-4">६. हकवालाको विवरण</h6>
<div class="row mb-3">
  <div class="col-md-4"><label>नाम</label><input class="form-control" name="nominee_name"></div>
  <div class="col-md-4"><label>सम्बन्ध</label><input class="form-control" name="nominee_relation"></div>
  <div class="col-md-4"><label>हक %</label><input type="number" class="form-control" name="nominee_share"></div>
</div>

<div class="row mb-3">
  <div class="col-md-4"><label>मोबाइल</label><input class="form-control" name="nominee_mobile"></div>
  <div class="col-md-4"><label>नागरिकता नं.</label><input class="form-control" name="nominee_citizenship_no"></div>
  <div class="col-md-4">
    <label>नागरिकता जारी जिल्ला</label>
    <select id="citizenship_district" class="form-select"></select>
  </div>
</div>

<!-- ================== 7. DOCUMENTS ================== -->
<h6 class="text-primary mt-4">७. फोटो तथा कागजात</h6>

<div class="row mb-3">
  <div class="col-md-4">
    <label>सदस्य फोटो</label>
    <input type="file" class="form-control" onchange="handleUpload(this,'member_photo')">
    <input type="text" id="member_photo_display" class="form-control mt-1" readonly>
    <input type="hidden" id="member_photo_url" name="member_photo_url">
  </div>

  <div class="col-md-4">
    <label>नागरिकता अगाडि</label>
    <input type="file" class="form-control" onchange="handleUpload(this,'member_citizen_front')">
    <input type="hidden" id="member_citizen_front_url">
  </div>

  <div class="col-md-4">
    <label>नागरिकता पछाडि</label>
    <input type="file" class="form-control" onchange="handleUpload(this,'member_citizen_back')">
    <input type="hidden" id="member_citizen_back_url">
  </div>
</div>
  <!-- 8. official use only -->
  <h6 class="text-danger mt-4">7. कार्यालयीय प्रयोग (Office Use Only)</h6>

<div class="row mb-3">
  <div class="col-md-4">
    <label class="form-label">दर्ता मिति</label>
    <input type="date" class="form-control" name="register_date">
  </div>

  <div class="col-md-4">
    <label class="form-label">स्वीकृत स्थिति</label>
    <select class="form-select" name="approval_status">
      <option>Pending</option>
      <option>Approved</option>
      <option>Rejected</option>
    </select>
  </div>

  <div class="col-md-4">
    <label class="form-label">Approved By</label>
    <input class="form-control" name="approved_by" placeholder="Chairman / Manager">
  </div>
</div>

<div class="row mb-3">
  <div class="col-md-6">
    <label class="form-label">पद</label>
    <input class="form-control" name="approved_designation">
  </div>
  <div class="col-md-6">
    <label class="form-label">कैफियत</label>
    <input class="form-control" name="remarks">
  </div>
</div>

<!-- ================== SUBMIT ================== -->
<div class="form-check mt-3">
  <input class="form-check-input" type="checkbox" required>
  <label class="form-check-label">म सहकारीको नियम पालना गर्न सहमत छु</label>
</div>

<div class="text-center mt-4">
  <button class="btn btn-success px-5">दर्ता गर्नुहोस्</button>
</div>

</form>
</div>
</div>
</div>

<!-- ================== JS ================== -->
<script>
const IMGBB_KEY = "f5d95811959fdcd59c8ea459aadb650b";
let addressData = {};

fetch("nepal-admin-structure.json")
.then(r=>r.json())
.then(d=>{
  addressData=d;
  province.innerHTML='<option>प्रदेश</option>';
  for(let p in d) province.innerHTML+=`<option>${p}</option>`;
});

province.onchange=()=>{
  district.innerHTML='<option>जिल्ला</option>';
  for(let x in addressData[province.value]) district.innerHTML+=`<option>${x}</option>`;
};

district.onchange=()=>{
  municipality.innerHTML='<option>पालिका</option>';
  addressData[province.value][district.value].forEach(m=>municipality.innerHTML+=`<option>${m}</option>`);
};

async function handleUpload(input,type){
  if(!member_id.value) return alert("पहिला खाता नं. लेख्नुहोस्");
  const fd=new FormData();
  fd.append("key",IMGBB_KEY);
  fd.append("name",member_id.value+"_"+type);
  fd.append("image",input.files[0]);

  const r=await fetch("https://api.imgbb.com/1/upload",{method:"POST",body:fd});
  const j=await r.json();
  document.getElementById(type+"_url").value=j.data.url;
  if(document.getElementById(type+"_display"))
    document.getElementById(type+"_display").value=j.data.url;
}
</script>

</body>
</html>
