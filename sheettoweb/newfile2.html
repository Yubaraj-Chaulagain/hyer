<!DOCTYPE html>
<html lang="ne">
<head>
  <meta charset="UTF-8">
  <title>‡§∏‡§π‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§¶‡§∞‡•ç‡§§‡§æ ‡§´‡§æ‡§∞‡§Æ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">
<div class="container my-4">
<div class="card shadow">
<div class="card-header bg-success text-white text-center">
  <h4 class="mb-0">‡§∏‡§π‡§ï‡§æ‡§∞‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§¶‡§∞‡•ç‡§§‡§æ ‡§´‡§æ‡§∞‡§Æ</h4>
</div>

<div class="card-body">
<form id="memberForm" enctype="multipart/form-data">

<!-- 1. Personal -->
<h6 class="text-primary">‡•ß. ‡§µ‡•ç‡§Ø‡§ï‡•ç‡§§‡§ø‡§ó‡§§ ‡§µ‡§ø‡§µ‡§∞‡§£</h6>
<div class="row mb-3">
  <div class="col-md-2">
    <label class="form-label">‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§®‡§Ç.</label>
    <input class="form-control" name="member_no">
  </div>
  <div class="col-md-3">
    <label class="form-label">‡§ñ‡§æ‡§§‡§æ ‡§®‡§Ç.</label>
    <input class="form-control" name="member_ac" id="member_id" required>
  </div>
  <div class="col-md-7">
    <label class="form-label">‡§™‡•Ç‡§∞‡§æ ‡§®‡§æ‡§Æ</label>
    <input class="form-control" name="full_name" required>
  </div>
</div>

<div class="row mb-3">
  <div class="col-md-4">
    <label class="form-label">‡§¨‡•Å‡§¨‡§æ‡§ï‡•ã ‡§®‡§æ‡§Æ</label>
    <input class="form-control" name="father_name">
  </div>
  <div class="col-md-4">
    <label class="form-label">‡§π‡§ú‡•Å‡§∞ ‡§¨‡•Å‡§¨‡§æ‡§ï‡•ã ‡§®‡§æ‡§Æ</label>
    <input class="form-control" name="grandfather_name">
  </div>
  <div class="col-md-4">
    <label class="form-label">‡§™‡§§‡§ø / ‡§™‡§§‡•ç‡§®‡•Ä</label>
    <input class="form-control" name="spouse_name">
  </div>
</div>

<div class="row mb-3">
  <div class="col-md-4">
    <label class="form-label">‡§≤‡§ø‡§ô‡•ç‡§ó</label>
    <select class="form-select" name="gender">
      <option>‡§™‡•Å‡§∞‡•Å‡§∑</option><option>‡§Æ‡§π‡§ø‡§≤‡§æ</option><option>‡§Ö‡§®‡•ç‡§Ø</option>
    </select>
  </div>
  <div class="col-md-4">
    <label class="form-label">‡§ú‡§®‡•ç‡§Æ ‡§Æ‡§ø‡§§‡§ø</label>
    <input type="date" class="form-control" name="dob">
  </div>
  <div class="col-md-4">
    <label class="form-label">‡§®‡§æ‡§ó‡§∞‡§ø‡§ï‡§§‡§æ ‡§®‡§Ç.</label>
    <input class="form-control" name="citizenship_no">
  </div>
</div>

<!-- 2. Address -->
<h6 class="text-primary mt-4">‡•®. ‡§†‡•á‡§ó‡§æ‡§®‡§æ</h6>
<div class="row mb-3">
  <div class="col-md-3">
  <label class="form-label">‡§™‡•ç‡§∞‡§¶‡•á‡§∂</label>
  <select class="form-select" name="province" id="province"></select>
</div>

<div class="col-md-3">
  <label class="form-label">‡§ú‡§ø‡§≤‡•ç‡§≤‡§æ</label>
  <select class="form-select" name="district" id="district"></select>
</div>

<div class="col-md-3">
  <label class="form-label">‡§™‡§æ‡§≤‡§ø‡§ï‡§æ</label>
  <select class="form-select" name="municipality" id="municipality"></select>
</div>
  <div class="col-md-3">
    <label class="form-label">‡§µ‡§°‡§æ ‡§®‡§Ç.</label>
    <input class="form-control" name="ward">
  </div>
</div>

<!-- 3. Contact -->
<h6 class="text-primary mt-4">‡•©. ‡§∏‡§Æ‡•ç‡§™‡§∞‡•ç‡§ï ‡§µ‡§ø‡§µ‡§∞‡§£</h6>
<div class="row mb-3">
  <div class="col-md-6">
    <label class="form-label">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç.</label>
    <input class="form-control" name="member_mobile">
  </div>
  <div class="col-md-6">
    <label class="form-label">‡§à‡§Æ‡•á‡§≤</label>
    <input type="email" class="form-control" name="member_email">
  </div>
</div>
  <!-- 4. member type -->
<h6 class="text-primary mt-4">‡•≠. ‡§∏‡§¶‡§∏‡•ç‡§Ø‡§ï‡•ã ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</h6>
<div class="row mb-3">
  <div class="col-md-6">
    <label class="form-label">‡§∏‡§¶‡§∏‡•ç‡§Ø‡§ï‡•ã ‡§™‡•ç‡§∞‡§ï‡§æ‡§∞</label>
    <select class="form-select" name="member_type" required>
      <option value="">‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</option>
      <option>‡§∏‡§æ‡§ß‡§æ‡§∞‡§£ ‡§∏‡§¶‡§∏‡•ç‡§Ø</option>
      <option>‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ‡§™‡§ï ‡§∏‡§¶‡§∏‡•ç‡§Ø</option>
      <option>‡§ã‡§£‡•Ä ‡§∏‡§¶‡§∏‡•ç‡§Ø</option>
      <option>‡§¨‡§æ‡§≤ ‡§∏‡§¶‡§∏‡•ç‡§Ø</option>
    </select>
  </div>

  <div class="col-md-6">
    <label class="form-label">‡§∏‡•á‡§Ø‡§∞ ‡§∏‡§Ç‡§ñ‡•ç‡§Ø‡§æ</label>
    <input type="number" class="form-control" name="share_count">
  </div>
  <div class="col-md-6">
    <label class="form-label">‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§∏‡•ç‡§•‡§ø‡§§‡§ø</label>
    <select class="form-select" name="member_status" required>
      <option value="">‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</option>
              <option>‡§∏‡§ï‡•ç‡§∞‡§ø‡§Ø</option>
              <option>‡§®‡§ø‡§∑‡•ç‡§ï‡•ç‡§∞‡§ø‡§Ø</option>
    </select>
  </div>
</div>

<!-- 5. Occupation -->
<h6 class="text-primary mt-4">‡•™. ‡§™‡•á‡§∂‡§æ ‡§§‡§•‡§æ ‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä</h6>
<div class="row mb-3">
  <div class="col-md-6">
    <label class="form-label">‡§™‡•á‡§∂‡§æ</label>
    <select class="form-select" name="occupation">
      <option>‡§ï‡•É‡§∑‡§ø</option><option>‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø</option><option>‡§∏‡•á‡§µ‡§æ</option>
      <option>‡§µ‡•à‡§¶‡•á‡§∂‡§ø‡§ï ‡§∞‡•ã‡§ú‡§ó‡§æ‡§∞‡•Ä</option><option>‡§Æ‡§ú‡§¶‡•Å‡§∞‡•Ä</option>
    </select>
  </div>
  <div class="col-md-6">
    <label class="form-label">‡§µ‡§æ‡§∞‡•ç‡§∑‡§ø‡§ï ‡§Ü‡§Æ‡•ç‡§¶‡§æ‡§®‡•Ä</label>
    <input type="number" class="form-control" name="annual_income">
  </div>
</div>

<!-- 6. Nominee -->
<h6 class="text-primary mt-4">‡•´. ‡§π‡§ï‡§µ‡§æ‡§≤‡§æ‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£</h6>

<div class="row mb-3">
  <div class="col-md-4">
    <label class="form-label">‡§π‡§ï‡§µ‡§æ‡§≤‡§æ‡§ï‡•ã ‡§®‡§æ‡§Æ</label>
    <input class="form-control" name="nominee_name" required>
  </div>
  <div class="col-md-4">
    <label class="form-label">‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß</label>
    <input class="form-control" name="nominee_relation">
  </div>
  <div class="col-md-4">
    <label class="form-label">‡§π‡§ï ‡§™‡•ç‡§∞‡§§‡§ø‡§∂‡§§ (%)</label>
    <input type="number" class="form-control" name="nominee_share">
  </div>
</div>

<div class="row mb-3">
  <div class="col-md-4">
    <label class="form-label">‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§®‡§Ç.</label>
    <input class="form-control" name="nominee_mobile">
  </div>
  <div class="col-md-4">
    <label class="form-label">‡§®‡§æ‡§ó‡§∞‡§ø‡§ï‡§§‡§æ ‡§®‡§Ç.</label>
    <input class="form-control" name="nominee_citizenship_no">
  </div>
  <div class="col-md-4">
  <label class="form-label">‡§®‡§æ‡§ó‡§∞‡§ø‡§ï‡§§‡§æ ‡§ú‡§æ‡§∞‡•Ä ‡§ú‡§ø‡§≤‡•ç‡§≤‡§æ</label>
  <select class="form-select" name="nominee_citizenship_district" id="citizenship_district">
    <option value="">‡§ú‡§ø‡§≤‡•ç‡§≤‡§æ ‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</option>
  </select>
</div>

<div class="row mb-3">
  <div class="col-md-6">
    <label class="form-label">‡§π‡§ï‡§µ‡§æ‡§≤‡§æ‡§ï‡•ã ‡§†‡•á‡§ó‡§æ‡§®‡§æ</label>
    <input class="form-control" name="nominee_address">
  </div>
  <div class="col-md-3">
    <label class="form-label">‡§®‡§æ‡§ó‡§∞‡§ø‡§ï‡§§‡§æ ‡§Ö‡§ó‡§æ‡§°‡§ø</label>
    <input type="file" class="form-control"
onchange="handleUpload(this,'nominee_front')">
<input type="text" class="form-control mt-1" id="nominee_front_url_display" readonly>
 <input type="hidden" name="nominee_citizenship_front_url" id="nominee_citizenship_front_url">
 </div>
  <div class="col-md-3">
    <label class="form-label">‡§®‡§æ‡§ó‡§∞‡§ø‡§ï‡§§‡§æ ‡§™‡§õ‡§æ‡§°‡§ø</label>
    <input type="file" class="form-control"
onchange="handleUpload(this,'nominee_back')">
<input type="text" class="form-control mt-1" id="nominee_back_url_display" readonly>
    <input type="hidden" name="nominee_citizenship_back_url" id="nominee_citizenship_back_url">
  </div>
</div>


<!-- 7. Documents -->
<h6 class="text-primary mt-4">‡•¨. ‡§´‡•ã‡§ü‡•ã ‡§§‡§•‡§æ ‡§ï‡§æ‡§ó‡§ú‡§æ‡§§</h6>
<div class="row mb-3">
  <div class="col-md-4">
    <label class="form-label">‡§∏‡§¶‡§∏‡•ç‡§Ø ‡§´‡•ã‡§ü‡•ã</label>
    <input type="file" class="form-control" name="photo"
onchange="handleUpload(this,'photo')">
<input type="text"
       class="form-control mt-1"
       id="photo_url_display"
       placeholder="Photo URL auto generate ‡§π‡•Å‡§®‡•ç‡§õ"
       readonly>
    <input type="hidden" name="photo_url" id="photo_url">

  </div>
  <div class="col-md-4">
    <label class="form-label">‡§®‡§æ‡§ó‡§∞‡§ø‡§ï‡§§‡§æ ‡§Ö‡§ó‡§æ‡§°‡§ø</label>
    <input type="file" class="form-control"
onchange="handleUpload(this,'citizen_front')">
<input type="text" class="form-control mt-1" id="citizenship_front_url_display" readonly>

    <input type="hidden" name="citizenship_front_url" id="citizenship_front_url">
  </div>
  <div class="col-md-4">
    <label class="form-label">‡§®‡§æ‡§ó‡§∞‡§ø‡§ï‡§§‡§æ ‡§™‡§õ‡§æ‡§°‡§ø</label>
   <input type="file" class="form-control"
onchange="handleUpload(this,'citizen_back')">
<input type="text" class="form-control mt-1" id="citizenship_back_url_display" readonly>

    <input type="hidden" name="citizenship_back_url" id="citizenship_back_url">
  </div>
</div>
  <!-- 8. official use only -->
  <h6 class="text-danger mt-4">7. ‡§ï‡§æ‡§∞‡•ç‡§Ø‡§æ‡§≤‡§Ø‡•Ä‡§Ø ‡§™‡•ç‡§∞‡§Ø‡•ã‡§ó (Office Use Only)</h6>

<div class="row mb-3">
  <div class="col-md-4">
    <label class="form-label">‡§¶‡§∞‡•ç‡§§‡§æ ‡§Æ‡§ø‡§§‡§ø</label>
    <input type="date" class="form-control" name="register_date">
  </div>

  <div class="col-md-4">
    <label class="form-label">‡§∏‡•ç‡§µ‡•Ä‡§ï‡•É‡§§ ‡§∏‡•ç‡§•‡§ø‡§§‡§ø</label>
    <select class="form-select" name="approval_status">
      <option>Pending</option>
      <option>Approved</option>
      <option>Rejected</option>
    </select>
  </div>

  <div class="col-md-4">
    <label class="form-label">Approved By</label>
    <input class="form-control" name="approved_by" placeholder="Chairman / Manager">
  </div>
</div>

<div class="row mb-3">
  <div class="col-md-6">
    <label class="form-label">‡§™‡§¶</label>
    <input class="form-control" name="approved_designation">
  </div>
  <div class="col-md-6">
    <label class="form-label">‡§ï‡•à‡§´‡§ø‡§Ø‡§§</label>
    <input class="form-control" name="remarks">
  </div>
</div>


<div class="form-check mt-3">
  <input class="form-check-input" type="checkbox" required>
  <label class="form-check-label">
    ‡§Æ ‡§∏‡§π‡§ï‡§æ‡§∞‡•Ä‡§ï‡•ã ‡§®‡§ø‡§Ø‡§Æ ‡§™‡§æ‡§≤‡§®‡§æ ‡§ó‡§∞‡•ç‡§® ‡§∏‡§π‡§Æ‡§§ ‡§õ‡•Å
  </label>
</div>

<div class="text-center mt-4">
  <button class="btn btn-success px-5">‡§¶‡§∞‡•ç‡§§‡§æ ‡§ó‡§∞‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</button>
</div>

</form>
</div>
</div>
</div>


  <script>
let addressData = {};

fetch('https://fulkumari.com.np/sheettoweb/nepal-admin-structure.json')
  .then(res => res.json())
  .then(data => {
    addressData = data;
    loadProvinces();
    loadCitizenshipDistricts(); // üëà add this
  });

function loadProvinces() {
  const province = document.getElementById('province');
  province.innerHTML = '<option value="">‡§™‡•ç‡§∞‡§¶‡•á‡§∂ ‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</option>';

  for (let p in addressData) {
    province.innerHTML += `<option value="${p}">${p}</option>`;
  }
}

document.getElementById('province').addEventListener('change', function () {
  const district = document.getElementById('district');
  const municipality = document.getElementById('municipality');

  district.innerHTML = '<option value="">‡§ú‡§ø‡§≤‡•ç‡§≤‡§æ ‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</option>';
  municipality.innerHTML = '<option value="">‡§™‡§æ‡§≤‡§ø‡§ï‡§æ ‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</option>';

  if (!this.value) return;

  for (let d in addressData[this.value]) {
    district.innerHTML += `<option value="${d}">${d}</option>`;
  }
});

document.getElementById('district').addEventListener('change', function () {
  const municipality = document.getElementById('municipality');
  municipality.innerHTML = '<option value="">‡§™‡§æ‡§≤‡§ø‡§ï‡§æ ‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</option>';

  const province = document.getElementById('province').value;
  if (!this.value) return;

  addressData[province][this.value].forEach(m => {
    municipality.innerHTML += `<option value="${m}">${m}</option>`;
  });
});
</script>
  <script>
function loadCitizenshipDistricts() {
  const districtSelect = document.getElementById('citizenship_district');
  districtSelect.innerHTML = '<option value="">‡§ú‡§ø‡§≤‡•ç‡§≤‡§æ ‡§õ‡§æ‡§®‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</option>';

  const added = new Set();

  for (let province in addressData) {
    for (let district in addressData[province]) {
      if (!added.has(district)) {
        added.add(district);
        districtSelect.innerHTML +=
          `<option value="${district}">${district}</option>`;
      }
    }
  }
}
</script>

  <script>
const IMGBB_API_KEY = "f5d95811959fdcd59c8ea459aadb650b";

async function uploadToImgbb(file, rename) {
  const formData = new FormData();
  formData.append("image", file);
  formData.append("name", rename);

  const res = await fetch(
    `https://api.imgbb.com/1/upload?key=${IMGBB_API_KEY}`,
    { method: "POST", body: formData }
  );

  const data = await res.json();
  return data.data.url;
}
</script>

  <script>
async function handleUpload(input, type) {
  const memberId = document.getElementById("member_id").value;
  if (!memberId) {
    alert("‡§™‡§π‡§ø‡§≤‡•á ‡§ñ‡§æ‡§§‡§æ ‡§®‡§Ç. ‡§π‡§æ‡§≤‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç");
    input.value = "";
    return;
  }

  const file = input.files[0];
  let rename = "";

  if (type === "photo") rename = `${memberId}_photo`;
  if (type === "citizen_front") rename = `${memberId}_citizen_front`;
  if (type === "citizen_back") rename = `${memberId}_citizen_back`;
  if (type === "nominee_front") rename = `${memberId}_nominee_citizen_front`;
  if (type === "nominee_back") rename = `${memberId}_nominee_citizen_back`;

  const url = await uploadToImgbb(file, rename);

  if (type === "photo") {
    document.getElementById("photo_url").value = url;
    document.getElementById("photo_url_display").value = url;
  }

  if (type === "citizen_front") {
    document.getElementById("citizenship_front_url").value = url;
    document.getElementById("citizenship_front_url_display").value = url;
  }

  if (type === "citizen_back") {
    document.getElementById("citizenship_back_url").value = url;
    document.getElementById("citizenship_back_url_display").value = url;
  }

  if (type === "nominee_front") {
    document.getElementById("nominee_citizenship_front_url").value = url;
    document.getElementById("nominee_front_url_display").value = url;
  }

  if (type === "nominee_back") {
    document.getElementById("nominee_citizenship_back_url").value = url;
    document.getElementById("nominee_back_url_display").value = url;
  }
}
</script>




</body>
</html>
