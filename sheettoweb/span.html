<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Wheel Winner Selection</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
  body {
    margin: 0;
    background: #0f172a;
    color: #fff;
    font-family: Arial, sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 100vh;
  }

  h2 {
    margin-bottom: 20px;
  }

  .wheel-container {
    position: relative;
    width: 320px;
    height: 320px;
  }

  .wheel {
    width: 100%;
    height: 100%;
    border-radius: 50%;
    border: 8px solid #fff;
    background: conic-gradient(
      #f87171 0deg 60deg,
      #34d399 60deg 120deg,
      #60a5fa 120deg 180deg,
      #fde047 180deg 240deg,
      #a78bfa 240deg 300deg,
      #2dd4bf 300deg 360deg
    );
    transition: transform 4s cubic-bezier(0.33,1,0.68,1);
  }

  .pointer {
    position: absolute;
    top: -18px;
    left: 50%;
    transform: translateX(-50%);
    width: 0;
    height: 0;
    border-left: 15px solid transparent;
    border-right: 15px solid transparent;
    border-bottom: 30px solid #ef4444;
  }

  button {
    margin-top: 30px;
    padding: 14px 30px;
    font-size: 18px;
    border: none;
    border-radius: 10px;
    cursor: pointer;
    background: #22c55e;
    color: #000;
  }

  button:disabled {
    background: #64748b;
    cursor: not-allowed;
  }

  .winner {
    margin-top: 20px;
    font-size: 18px;
    color: #38bdf8;
  }
</style>
</head>

<body>

<h2>ğŸ‰ Lucky Draw Wheel ğŸ‰</h2>

<div class="wheel-container">
  <div class="pointer"></div>
  <div class="wheel" id="wheel"></div>
</div>

<button id="spinBtn" onclick="spinWheel()">SPIN</button>

<div class="winner" id="winnerText"></div>

<script>
/* ğŸ”— PASTE YOUR GOOGLE APPS SCRIPT WEB APP URL */
const API_URL = "https://script.google.com/macros/s/AKfycbxXvv3UZsIANrX2wJ-yBTLQBufzTEWYq-wULilOZ32wJmmRAx5JIA_TnKXJe2qxUj08/exec";

let members = [];
let rotation = 0;

/* ğŸ”„ Load Members from Google Sheet */
fetch(API_URL)
  .then(res => res.json())
  .then(data => {
    members = data;
    console.log("Members loaded:", members);
  })
  .catch(err => alert("Failed to load members"));

function spinWheel() {
  if (members.length === 0) {
    alert("No members found!");
    return;
  }

  document.getElementById("spinBtn").disabled = true;

  const wheel = document.getElementById("wheel");

  const spin = Math.floor(Math.random() * 360) + 1440;
  rotation += spin;
  wheel.style.transform = `rotate(${rotation}deg)`;

  setTimeout(() => {
    const index = Math.floor(Math.random() * members.length);
    const winner = members[index];

    document.getElementById("winnerText").innerHTML =
      "ğŸ† Winner: <b>" + winner.name + "</b><br>ID: " + winner.memberId;

    // ğŸ’¾ Save winner + ğŸ“§ Gmail send
    fetch(API_URL, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify(winner)
    });

    document.getElementById("spinBtn").disabled = false;

  }, 4200);
}
</script>

</body>
</html>
