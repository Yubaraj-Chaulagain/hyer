<!-- TRANSACTION FORM -->
<div class="card p-3 mt-3">
  <h5>New Transaction</h5>

  <select id="tType" class="form-control mb-2" onchange="toggleTxnFields()">
    <option value="">-- Select Type --</option>
    <option value="deposit">Deposit</option>
    <option value="withdraw">Withdraw</option>
    <option value="buy">Buy</option>
    <option value="sell">Sell</option>
  </select>

  <input id="tMemberID" class="form-control mb-2" placeholder="Member ID">

  <input id="tAmount" class="form-control mb-2" placeholder="Amount">

  <!-- BUY / SELL only -->
  <div id="itemBox" style="display:none">
    <input id="tItemID" class="form-control mb-2" placeholder="Item ID">
    <input id="tQty" class="form-control mb-2" placeholder="Quantity">
  </div>

  <button class="btn btn-success" onclick="submitTransaction()">Submit</button>
</div>
<script>
const scriptURL = "https://script.google.com/macros/s/AKfycby5Fybue7tKj8FrYSVEWUDSTIG5oeutoVinIGEuj9RrfXzBQZt7qFIFSAsbmL7P6Yc/exec";

function toggleTxnFields(){
  const type = document.getElementById("tType").value;
  document.getElementById("itemBox").style.display =
    (type === "buy" || type === "sell") ? "block" : "none";
}

function submitTransaction(){
  const type = document.getElementById("tType").value;

  if(!type){
    alert("Select transaction type");
    return;
  }

  let payload = {
    action: type,
    MemberID: document.getElementById("tMemberID").value,
    Amount: document.getElementById("tAmount").value
  };

  if(type === "buy" || type === "sell"){
    payload.ItemID = document.getElementById("tItemID").value;
    payload.Qty = document.getElementById("tQty").value;
  }

  fetch(scriptURL,{
    method:"POST",
    body: JSON.stringify(payload)
  })
  .then(r=>r.json())
  .then(res=>{
    if(res.status){
      alert("✅ Transaction successful");
    }else{
      alert("❌ Failed");
    }
  });
}
</script>

