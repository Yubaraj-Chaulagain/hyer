<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Co-Operative Dashboard</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<style>
body{font-family:Arial;background:#f4f6f8}
.card{background:#fff;padding:15px;border-radius:8px;margin:10px;display:inline-block;width:200px}
</style>
</head>
<body>

<h2>Dashboard</h2>

<div class="card" id="members">Members: 0</div>
<div class="card" id="collection">Collection: 0</div>

<canvas id="chart" width="400"></canvas>

<script>
const WEBAPP_URL = 'https://script.google.com/macros/s/AKfycbycxxXxgXOkTWYirzF37Uggtz9NOu-yp6-wd_lk_Yq5YQCl_OwHSnC9Dn9kOTGqdcfD/exec';

function api(action,data={}){
  return fetch(WEBAPP_URL,{
    method:'POST',
    body:JSON.stringify({...data,action})
  }).then(r=>r.json());
}

async function loadDashboard(){
  const d = await api('dashboard');
  document.getElementById('members').innerText='Members: '+d.members;
  document.getElementById('collection').innerText='Collection: '+d.totalCollection;

  new Chart(document.getElementById('chart'),{
    type:'bar',
    data:{
      labels:['Members','Collection'],
      datasets:[{data:[d.members,d.totalCollection]}]
    }
  });
}

loadDashboard();
</script>
</body>
</html>
