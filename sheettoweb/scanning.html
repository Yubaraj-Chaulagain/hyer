<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Mini ERP Dashboard</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body{padding:20px;} .card{margin-bottom:15px;}
</style>
</head>
<body>
<h3>Mini ERP Dashboard</h3>

<div id="loginDiv">
<input id="u" class="form-control mb-2" placeholder="Username">
<input id="p" type="password" class="form-control mb-2" placeholder="Password">
<button class="btn btn-primary mb-3" onclick="login()">Login</button>
</div>

<div id="dashboard" style="display:none;">
<h4>Add Member</h4>
<input id="mname" class="form-control mb-2" placeholder="Name">
<input id="maddress" class="form-control mb-2" placeholder="Address">
<input id="mfamily" class="form-control mb-2" placeholder="Family Background">
<input id="mphone" class="form-control mb-2" placeholder="Phone">
<input id="mgmail" class="form-control mb-2" placeholder="Gmail">
<button class="btn btn-success mb-3" onclick="addMember()">Add Member</button>

<h4>Reports</h4>
<div id="reports"></div>
</div>

<script>
const API="https://script.google.com/macros/s/AKfycbylZ1LA98PTumqG1jmTcW1bJseBH7pzjnUz8qAMgGMUdYghOJXNn6-nXDZbbldboKvH/exec";

function login(){
 fetch(API,{method:"POST",body:new URLSearchParams({action:"login",u:u.value,p:p.value})})
 .then(r=>r.json()).then(d=>{
  if(d.status=="success"){loginDiv.style.display="none";dashboard.style.display="block"; loadReports();}
  else alert("Login Failed");
 });
}

function addMember(){
 fetch(API,{method:"POST",body:new URLSearchParams({action:"addMember",name:mname.value,address:maddress.value,family:mfamily.value,phone:mphone.value,gmail:mgmail.value})})
 .then(r=>r.json()).then(d=>{ alert("Member Added"); });
}

function loadReports(){
 fetch(API+"?action=getReports").then(r=>r.json()).then(d=>{
  let html="<table class='table table-bordered'><tr><th>Date</th><th>Type</th><th>RefID</th><th>Debit</th><th>Credit</th></tr>";
  d.slice(1).forEach(r=>{html+="<tr><td>"+r[0]+"</td><td>"+r[1]+"</td><td>"+r[2]+"</td><td>"+r[3]+"</td><td>"+r[4]+"</td></tr>";});
  html+="</table>";
  reports.innerHTML=html;
 });
}
</script>
</body>
</html>
