<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ERP Billing System</title>

<meta name="viewport" content="width=device-width,initial-scale=1">
<link rel="manifest" href="manifest.json">

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://unpkg.com/html5-qrcode"></script>

<style>
body{margin:0;font-family:Arial;background:#f2f2f2}
header{background:#0d6efd;color:white;padding:10px}
nav button{margin:3px}
.card{background:white;margin:10px;padding:15px;border-radius:8px}
.hidden{display:none}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ccc;padding:5px}
input,select,button{padding:6px;margin:3px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr))}
</style>
</head>
<body>
<div id="login" class="card">
<h2>Login</h2>
<input id="u" placeholder="Username">
<input id="p" type="password" placeholder="Password">
<button onclick="doLogin()">Login</button>
<p id="err"></p>
</div>

<div id="app" class="hidden">
<header>
<b id="r"></b>
<nav>
<button onclick="show('dash')">Dashboard</button>
<button onclick="show('members')">Members</button>
<button onclick="show('items')">Items</button>
<button onclick="show('billing')">Billing</button>
<button onclick="show('finance')">Finance</button>
<button onclick="show('reports')">Reports</button>
<button onclick="logout()">Logout</button>
</nav>
</header>
<div id="dash" class="card">
<div class="grid">
<div class="card">Members <b id="mc">0</b></div>
<div class="card">Items <b id="ic">0</b></div>
<div class="card">Stock <b id="st">0</b></div>
</div>
<canvas id="pie"></canvas>
<canvas id="bar"></canvas>
</div>
<div id="members" class="card hidden">
<h3>Members</h3>
<form onsubmit="addMember(event)">
<input id="mn" placeholder="Name">
<input id="mp" placeholder="Phone">
<button>Add</button>
</form>
<table id="mt"><tr><th>Name</th><th>Phone</th></tr></table>
</div>
<div id="items" class="card hidden">
<h3>Items</h3>
<form onsubmit="addItem(event)">
<input id="in" placeholder="Item">
<input id="br" placeholder="Buy">
<input id="sr" placeholder="Sell">
<button>Add</button>
</form>
<table id="it"><tr><th>Name</th><th>Sell</th></tr></table>
</div>
<div id="billing" class="card hidden">
<h3>Billing</h3>
<div id="qr"></div>
<button onclick="scan()">Scan QR</button>
<div id="invoice"></div>
<button onclick="window.print()">Print</button>
</div>
<div id="finance" class="card hidden">
<h3>Finance</h3>
<form onsubmit="finance(event)">
<select id="ft">
<option>Saving</option>
<option>Withdraw</option>
<option>Transfer</option>
<option>Loan</option>
</select>
<input id="fa" placeholder="Amount">
<input id="months" placeholder="Months (Loan only)">
<button>Submit</button>
</form>
</div>
<div id="reports" class="card hidden">
<h3>Reports</h3>
<table id="rt"><tr><th>Date</th><th>Type</th><th>Amount</th></tr></table>
</div>
<script>
const ID="1LRvZ1kXb777L0FfNtQk8Yo_YC7Ewu35x68lIPkBQgjM";
const API=s=>`https://opensheet.elk.sh/${ID}/${s}`;
const FORM={
member:"MEMBER_FORM_URL",
item:"ITEM_FORM_URL",
payment:"PAYMENT_FORM_URL"
};