<!DOCTYPE html>
<html>
<head>
<title>Login System</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
.hidden{display:none}
</style>
</head>
<body class="p-4">

<!-- LOGIN -->
<div id="loginBox" class="col-md-4 mx-auto">
  <h4>ğŸ” Login</h4>
  <input id="user" class="form-control mb-2" placeholder="Username">
  <input id="pass" type="password" class="form-control mb-2" placeholder="Password">
  <button class="btn btn-primary w-100" onclick="login()">Login</button>
</div>

<!-- ADMIN -->
<div id="adminUI" class="hidden">
  <h3>ğŸ‘‘ Admin Dashboard</h3>
</div>

<!-- STAFF -->
<div id="staffUI" class="hidden">
  <h3>ğŸ§‘â€ğŸ’¼ Staff Dashboard</h3>
</div>

<!-- MEMBER -->
<div id="memberUI" class="hidden">
  <h3>ğŸ‘¤ Member Dashboard</h3>
  <div id="myInfo"></div>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbx3QtkGadxdeAcGh0Z2wWRQs5EmaLeE8mtKXIm4uPJxMX28ShblIvJI9H480N16dPUn/exec";

let headers=[], members=[], edit=false, role="";

function login(){
  const username = document.getElementById("user").value.trim();
  const password = document.getElementById("pass").value.trim();

  if(!username || !password){
    alert("Username & Password required");
    return;
  }

 fetch(API,{
  method:"POST",
  redirect:"follow",
  headers:{ "Content-Type":"application/json" },
  body: JSON.stringify({
    action:"login",
    user: username,
    pass: password
  })
})
  .then(r=>{
    if(!r.ok) throw new Error("HTTP Error");
    return r.json();
  })
  .then(d=>{
    console.log("LOGIN RESPONSE:", d);
    if(!d.ok){
      alert("âŒ Login failed");
      return;
    }
    role = d.role;
    document.getElementById("loginBox").classList.add("hidden");
    document.getElementById("app").classList.remove("hidden");
    load();
  })
  .catch(err=>{
    console.error("LOGIN FETCH ERROR:", err);
    alert("âŒ API Error (HTML side)");
  });
}

</script>


</body>
</html>
