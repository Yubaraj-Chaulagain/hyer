<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Animated Scrolling Table</title>
<style>
    /* Container for the table to enable scrolling */
    .table-container {
        height: 500px; /* Fixed height for the scrollable area */
        overflow: hidden; /* Hide the scrollbar */
        border: 1px solid #ccc;
        box-shadow: inset 0 0 10px rgba(0,0,0,0.1);
    }

    /* The actual table for the content */
    .animated-table {
        border-collapse: collapse;
        width: 100%;
    }

    /* Style for table cells */
    .animated-table td {
        padding: 10px;
        border-bottom: 1px solid #ddd;
        font-family: sans-serif;
    }

    /* Alternating row colors for better readability */
    .animated-table tr:nth-child(even) {
        background-color: #f9f9f9;
    }
</style>
</head>
<body>

<h1>Automatic Animated Scrolling Table</h1>

<div class="table-container">
  <div id="myDivToExport"></div>
    
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const container = document.querySelector('.table-container');
        const table = document.querySelector('.animated-table');
        let scrollSpeed = 10; // Speed in milliseconds (lower is faster)
        let scrollStep = 1; // Pixels per step

        function autoScrollUp() {
            // Scroll the container up by one pixel
            container.scrollTop += scrollStep;

            // Check if the scroll has reached the end
            if (container.scrollTop + container.clientHeight >= table.scrollHeight) {
                // If at the end, jump back to the top seamlessly
                // This is done by appending the first row to the end, then scrolling back to 0
                const firstRow = table.querySelector('tr');
                table.appendChild(firstRow.cloneNode(true));
                firstRow.remove();
                container.scrollTop = container.scrollTop - firstRow.offsetHeight;
            }
        }

        // Set an interval to call the scrolling function
        let scrollInterval = setInterval(autoScrollUp, scrollSpeed);

        // Optional: Pause scrolling on hover
        container.addEventListener('mouseenter', () => {
            clearInterval(scrollInterval);
        });

        container.addEventListener('mouseleave', () => {
            scrollInterval = setInterval(autoScrollUp, scrollSpeed);
        });
    });
</script>

</body>
  
    <script>
      const sheetId = '1PwjlV_rc3ybi66Fc2GmagAOUILrwzeo7wU2E9PteTRo'; // Get this from your sheet's URL
      const gid = '1071393189'; // Get this from your sheet's URL (0 for the first sheet)
      const queryUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&tq&gid=${gid}`;

      fetch(queryUrl)
        .then(response => response.text())
        .then(data => {
          const jsonString = data.substring(data.indexOf("google.visualization.Query.setResponse(") + 39, data.lastIndexOf(");"));
          const jsonData = JSON.parse(jsonString);
          const table = jsonData.table;

          let html = '<table id="myTable" class="animated-table" padding: 10px; cellspacing="0" width="100%"><thead padding: 10px;><tr padding: 10px;>';
          table.cols.forEach(col => {
            html += `<th>${col.label}</th>`;
          });
          html += '</tr></thead><tbody>';

          table.rows.forEach(row => {
            html += '<tr>';
            row.c.forEach(cell => {
              html += `<td>${cell && (cell.f || cell.v) ? (cell.f || cell.v) : ''}</td>`;
            });
            html += '</tr>';
          });
          html += '</tbody></table>';

          document.getElementById('myDivToExport').innerHTML = html;
        })
        .catch(error => console.error('Error fetching sheet data:', error));
    </script>
<script>
      const sheetIds = '1PwjlV_rc3ybi66Fc2GmagAOUILrwzeo7wU2E9PteTRo'; // Get this from your sheet's URL
      const gids = '43821471'; // Get this from your sheet's URL (0 for the first sheet)
      const queryUrls = `https://docs.google.com/spreadsheets/d/${sheetIds}/gviz/tq?tqx=out:json&tq&gid=${gids}`;

      fetch(queryUrls)
        .then(response => response.text())
        .then(data => {
          const jsonString = data.substring(data.indexOf("google.visualization.Query.setResponse(") + 39, data.lastIndexOf(");"));
          const jsonData = JSON.parse(jsonString);
          const table = jsonData.table;

          let html = '<table id="myTable" class="animated-table"  cellspacing="0" width="100%"><thead><tr>';
          table.cols.forEach(col => {
            html += `<th>${col.label}</th>`;
          });
          html += '</tr></thead><tbody>';

          table.rows.forEach(row => {
            html += '<tr>';
            row.c.forEach(cell => {
              html += `<td>${cell && (cell.f || cell.v) ? (cell.f || cell.v) : ''}</td>`;
            });
            html += '</tr>';
          });
          html += '</tbody></table>';

          document.getElementById('myDivToExport').innerHTML = html;
        })
        .catch(error => console.error('Error fetching sheet data:', error));
    </script>

</html>
