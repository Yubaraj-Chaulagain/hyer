<!DOCTYPE html>   
<html lang="en">   
<head>   
<meta charset="utf-8">   
<title>Marin Fant Project</title>   
<meta name="description" content="Bootstrap.">  
<link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">   
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<link rel="stylesheet" href="http://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css"></style>
<script type="text/javascript" src="http://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
</head>  
	<style>
		    .table table-striped table-bordered table-responsive table-hover tbody {
        display: block; /* Important for applying height and overflow */
        height: 200px; /* Set a fixed height for the scrollable area */
        overflow-y: auto; /* Enable vertical scrollbar when content exceeds height */
    }

    .table table-striped table-bordered table-responsive table-hover thead,
    .table table-striped table-bordered table-responsive table-hover tbody tr {
        display: table; /* Or block, depending on desired layout */
        width: 100%;
        table-layout: fixed; /* Optional: ensures consistent column widths */
    }

    .table table-striped table-bordered table-responsive table-hover thead th,
    .table table-striped table-bordered table-responsive table-hover tbody td {
        /* Adjust width as needed to match header and body cells */
        width: 50%; /* Example for two columns */
    }
		    .table table-striped table-bordered table-responsive table-hover {
        max-width: 150px; /* Set a maximum width for the cell */
        overflow-x: auto; /* Enable horizontal scrollbar when content exceeds max-width */
        white-space: nowrap; /* Prevent text from wrapping */
    }
	</style>
<body style="margin:20px auto"> 
	<script>
		function scrollToBottom(elementId) {
        const element = document.getElementById(elementId);
        if (element) {
            element.scrollTop = element.scrollHeight;
        }
    }

    // Call this function when new content is added or on page load
    // Example: scrollToBottom('myScrollableTableBody');
	</script>
	<script>
	function searchTable() {
  // Declare variables
  var input, filter, table, tr, td, i, j, txtValue;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase(); // Get the search input and convert to uppercase for case-insensitive search
  table = document.getElementById("myTable");
  tr = table.getElementsByTagName("tr"); // Get all table rows

  // Loop through all table rows, and hide those who don't match the search query
  for (i = 0; i < tr.length; i++) {
    // Skip the header row if present (optional, adjust based on your table structure)
    if (tr[i].getElementsByTagName("th").length > 0) {
      continue;
    }

    var found = false;
    td = tr[i].getElementsByTagName("td"); // Get all cells in the current row

    // Loop through all cells in the current row
    for (j = 0; j < td.length; j++) {
      txtValue = td[j].textContent || td[j].innerText; // Get the text content of the cell
      if (txtValue.toUpperCase().indexOf(filter) > -1) { // Check if the cell content contains the filter text
        found = true;
        break; // If found in any cell, no need to check further in this row
      }
    }

    // Show or hide the row based on whether a match was found
    if (found) {
      tr[i].style.display = "";
    } else {
      tr[i].style.display = "none";
    }
  }
}
	</script>
	
<div class="container">
<div class="row header" style="text-align:center;color:green">
<h3>Marin Fant Project Members</h3>
</div><div><input type="text" id="myInput" onkeyup="searchTable()" placeholder="Search for names..">
	<div class="scrool" id="myDivToExport"></div>
	</div>
</div>
</body>  


	<script>
      const sheetId = '1PwjlV_rc3ybi66Fc2GmagAOUILrwzeo7wU2E9PteTRo'; // Get this from your sheet's URL
      const gid = '1990529604'; // Get this from your sheet's URL (0 for the first sheet)
      const queryUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&tq&gid=${gid}`;

      fetch(queryUrl)
        .then(response => response.text())
        .then(data => {
          const jsonString = data.substring(data.indexOf("google.visualization.Query.setResponse(") + 39, data.lastIndexOf(");"));
          const jsonData = JSON.parse(jsonString);
          const table = jsonData.table;

          let html = '<table id="myTable" class="table table-striped table-bordered table-responsive table-hover" ><thead><tr>';
          table.cols.forEach(col => {
            html += `<th>${col.label}</th>`;
          });
          html += '</tr></thead><tbody>';

          table.rows.forEach(row => {
            html += '<tr>';
            row.c.forEach(cell => {
              html += `<td>${cell && (cell.f || cell.v) ? (cell.f || cell.v) : ''}</td>`;
            });
            html += '</tr>';
          });
          html += '</tbody></table>';

          document.getElementById('myDivToExport').innerHTML = html;
        })
        .catch(error => console.error('Error fetching sheet data:', error));
    </script>
<script>
$(document).ready(function(){
    $('#myTable').dataTable();
});
</script>
</html> 
