<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<title>Scrollable Responsive Table</title>
<meta name="description" content="Bootstrap DataTables Scrollable.">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="http://cdn.datatables.net/1.10.2/css/jquery.dataTables.min.css">
<style>
    /* Custom CSS to ensure proper table rendering with DataTables scrolling */
    /* Add a max-height to the scrollable body, adjust as needed */
    .dataTables_wrapper .dataTables_scrollBody {
        max-height: 400px; /* Example height: adjust this value as needed (e.g., 50vh for dynamic height) */
        overflow-y: auto;
    }
    /* Ensure columns don't wrap to maintain horizontal scrolling functionality */
    th, td { white-space: nowrap; }
</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
<script type="text/javascript" src="http://cdn.datatables.net/1.10.2/js/jquery.dataTables.min.js"></script>
<script type="text/javascript" src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
</head>
<body style="margin:20px auto">
<div class="container">
    <div class="row header" style="text-align:center;color:green">
        <h3>Scrollable Data Table</h3>
    </div>
    <div id="myDivToExport"></div>
</div>

<script>
    const sheetId = '1tqLxrlHP4V_-DHhUQT_x3Fq-1gBCGRcH5ABJyzs2n0'; // Get this from your sheet's URL
    const gid = '1605291961'; // Get this from your sheet's URL (0 for the first sheet)
    const queryUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&tq&gid=${gid}`;

    fetch(queryUrl)
        .then(response => response.text())
        .then(data => {
            const jsonString = data.substring(data.indexOf("google.visualization.Query.setResponse(") + 39, data.lastIndexOf(");"));
            const jsonData = JSON.parse(jsonString);
            const table = jsonData.table;
            let html = '<table id="myTable" class="table table-striped table-bordered table-hover" ><thead><tr>';

            table.cols.forEach(col => {
                html += `<th>${col.label}</th>`;
            });
            html += '</tr></thead><tbody>';

            table.rows.forEach(row => {
                html += '<tr>';
                row.c.forEach(cell => {
                    html += `<td>${cell && (cell.f || cell.v) ? (cell.f || cell.v) : ''}</td>`;
                });
                html += '</tr>';
            });
            html += '</tbody></table>';

            $('#myDivToExport').html(html); // Place the HTML table in the div

            // Initialize DataTables with scrolling and searching enabled
            $('#myTable').DataTable({
                "paging": false, // Disable pagination to use full vertical scrolling
                "scrollY": "400px", // Enable vertical scrolling and set container height
                "scrollX": true, // Enable horizontal scrolling for wide tables
                "scrollCollapse": true // Allow the table container to shrink if data is less than scrollY height
            });
        })
        .catch(error => console.error('Error fetching data:', error));
</script>
</body>
</html>
