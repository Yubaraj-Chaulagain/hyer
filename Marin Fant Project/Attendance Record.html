<input type="text" id="searchInput" onkeyup="filterTable()" placeholder="Search table...">
<input type="text" id="myInput" onkeyup="filterTable()" placeholder="Search first column...">
<div id="sheetTable"></div>
<script>
function filterTable() {
  // Declare variables
  let input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase(); // Convert input to uppercase for case-insensitive search
  table = document.getElementById("myTable");
  tr = table.getElementsByTagName("tr");

  // Loop through all table rows, and hide those who don't match the search query
  for (i = 0; i < tr.length; i++) {
    // Skip the header row
    if (tr[i].getElementsByTagName("th").length > 0) {
      continue;
    }

    td = tr[i].getElementsByTagName("td")[0]; // Get the first column's data cell
    if (td) {
      txtValue = td.textContent || td.innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = ""; // Show the row
      } else {
        tr[i].style.display = "none"; // Hide the row
      }
    }
  }
}

</script>


    <script>
      const sheetId = '1Ka1Gmcj2_ifRo4kEzDhlrFUGccutelWJ9HlCkXPyF5c'; // Get this from your sheet's URL
      const gid = '1829014388'; // Get this from your sheet's URL (0 for the first sheet)
      const queryUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&tq&gid=${gid}`;

      fetch(queryUrl)
        .then(response => response.text())
        .then(data => {
          const jsonString = data.substring(data.indexOf("google.visualization.Query.setResponse(") + 39, data.lastIndexOf(");"));
          const jsonData = JSON.parse(jsonString);
          const table = jsonData.table;

          let html = '<table id="myTable"><thead><tr>';
          table.cols.forEach(col => {
            html += `<th>${col.label}</th>`;
          });
          html += '</tr></thead><tbody>';

          table.rows.forEach(row => {
            html += '<tr>';
            row.c.forEach(cell => {
              html += `<td>${cell && (cell.f || cell.v) ? (cell.f || cell.v) : ''}</td>`;
            });
            html += '</tr>';
          });
          html += '</tbody></table>';

          document.getElementById('sheetTable').innerHTML = html;
        })
        .catch(error => console.error('Error fetching sheet data:', error));
    </script>
<style>
   table {
  border-collapse: collapse; /* Essential for single borders */
}

th, td {
  border: 1px solid black; /* Applies a 1px solid black border to all header and data cells */
  padding: 4px; /* Adds spacing within cells */
  text-align: center;
  font-size: 15px;
}

tr {
  border-bottom: 1px solid grey; /* Applies a bottom border to each row */
}
    th {
  background-color: darkgray;
  color: white; /* For better contrast with dark background */
}

td {
  background-color: white;
}

}
</style>
<script>
function filterTable() {
  const searchInput = document.getElementById("searchInput");
  const filter = searchInput.value.toLowerCase();
  const table = document.getElementById("myTable");
  const tr = table.getElementsByTagName("tr");

  for (let i = 0; i < tr.length; i++) {
    let td = tr[i].getElementsByTagName("td");
    if (td.length > 0) { // Ensure it's a data row, not a header
      let rowText = tr[i].innerText.toLowerCase();
      if (rowText.includes(filter)) {
        tr[i].style.display = ""; // Show the row
      } else {
        tr[i].style.display = "none"; // Hide the row
      }
    }
  }
}
</script>
