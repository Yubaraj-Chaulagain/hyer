<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no">
	<title>Marin Fant Sanchai</title>
	<link rel="shortcut icon" type="image/png" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTGmXbq43U6t2HHnO0gFTKeyX4z8hah6UABcbrq7rBI_w&s">
	<link rel="alternate" type="application/rss+xml" title="RSS 2.0" href="http://www.datatables.net/rss.xml">
	<link rel="stylesheet" type="text/css" href="/media/css/site-examples.css?_=41cab7b2e63a641a482f02634433cc4c1">
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/1.13.4/css/jquery.dataTables.min.css">
	<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/buttons/2.3.6/css/buttons.dataTables.min.css">
	<style type="text/css" class="init">
	</style>
	<script src="/media/js/dynamic.php?comments-page=extensions%2Fbuttons%2Fexamples%2Fhtml5%2Fsimple.html"></script>
	<script type="text/javascript" language="javascript" src="https://code.jquery.com/jquery-3.5.1.js"></script>
	<script type="text/javascript" language="javascript" src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
	<script type="text/javascript" language="javascript" src="https://cdn.datatables.net/buttons/2.3.6/js/dataTables.buttons.min.js"></script>
	<script type="text/javascript" language="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
	<script type="text/javascript" language="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
	<script type="text/javascript" language="javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
	<script type="text/javascript" language="javascript" src="https://cdn.datatables.net/buttons/2.3.6/js/buttons.html5.min.js"></script>
<script type="text/javascript" class="init">
$(document).ready(function() {
	$('#table').DataTable( {
		dom: 'Bfrtip',
		buttons: [
			'copyHtml5',
			'excelHtml5',
			'csvHtml5',
			'pdfHtml5'
		]
	} );
} );

</script>
	
<iframe name="print_frame" width="0" height="0" frameborder="0" src="about:blank"></iframe>
	
<script>
function printDiv() {
window.frames["print_frame"].document.body.innerHTML = document.getElementById("table4").innerHTML;
window.frames["print_frame"].window.focus();
window.frames["print_frame"].window.print();
}
</script>
	
	</head>
<body class="wide comments example"><p style="Align:center"><button class="Button Button--outline" onclick="printDiv()">Print</button></p>


Search For Table..<input type="text" id="searchInput" onkeyup="filterTablee()" placeholder="Search table...">
Search for Tranjection Member Code:<input type="text" id="myInput" onkeyup="filterTable()" placeholder="Search For Tranjection Member Code..."></br>
<label for="startDate">Start Date:</label>
<input type="text" id="startDate">

<label for="endDate">End Date:</label>
<input type="text" id="endDate">

<button onclick="filterTableByDate()">Filter</button>
<script>
 function filterTableByDate() {
  const startDateInput = document.getElementById('startDate');
  const endDateInput = document.getElementById('endDate');
  const table = document.getElementById('myTable');
  const rows = table.getElementsByTagName('tr');

  const startDate = new Date(startDateInput.value);
  const endDate = new Date(endDateInput.value);

  // Loop through all table rows, and hide those that don't match the search query
  for (let i = 1; i < rows.length; i++) { // Start from 1 to skip the header row
    const dateCell = rows[i].getElementsByTagName('td')[0]; // Assuming date is in the first column (index 1)
    if (dateCell) {
      const rowDate = new Date(dateCell.textContent);

      if (rowDate >= startDate && rowDate <= endDate) {
        rows[i].style.display = ''; // Show the row
      } else {
        rows[i].style.display = 'none'; // Hide the row
      }
    }
  }
} 
</script>

<script>
function filterTable() {
  // Declare variables
  let input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("myInput");
  filter = input.value.toUpperCase(); // Convert input to uppercase for case-insensitive search
  table = document.getElementById("myTable");
  tr = table.getElementsByTagName("tr");

  // Loop through all table rows, and hide those who don't match the search query
  for (i = 0; i < tr.length; i++) {
    // Skip the header row
    if (tr[i].getElementsByTagName("th").length > 0) {
      continue;
    }

    td = tr[i].getElementsByTagName("td")[2]; // Get the first column's data cell
    if (td) {
      txtValue = td.textContent || td.innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
        tr[i].style.display = ""; // Show the row
      } else {
        tr[i].style.display = "none"; // Hide the row
      }
    }
  }
}

</script>


	<div id="table4"></div>
    <script>
      const sheetId = '1tqLxrlHP4V_-DHhUQT_x3Fq-1gBCGRcH5ABJyzs2nU0'; // Get this from your sheet's URL
      const gid = '1605291961'; // Get this from your sheet's URL (0 for the first sheet)
      const queryUrl = `https://docs.google.com/spreadsheets/d/${sheetId}/gviz/tq?tqx=out:json&tq&gid=${gid}`;

      fetch(queryUrl)
        .then(response => response.text())
        .then(data => {
          const jsonString = data.substring(data.indexOf("google.visualization.Query.setResponse(") + 39, data.lastIndexOf(");"));
          const jsonData = JSON.parse(jsonString);
          const table = jsonData.table;

          let html = '<table id="myTable" class="display" cellspacing="0" width="100%">
<thead><tr>';
          table.cols.forEach(col => {
            html += `<th>${col.label}</th>`;
          });
          html += '</tr></thead><tbody>';

          table.rows.forEach(row => {
            html += '<tr>';
            row.c.forEach(cell => {
              html += `<td>${cell && (cell.f || cell.v) ? (cell.f || cell.v) : ''}</td>`;
            });
            html += '</tr>';
          });
          html += '</tbody></table></div></body>';

          document.getElementById('sheetTable').innerHTML = html;
        })
        .catch(error => console.error('Error fetching sheet data:', error));
    </script>

<script>
function filterTablee() {
  const searchInput = document.getElementById("searchInput");
  const filter = searchInput.value.toLowerCase();
  const table = document.getElementById("myTable");
  const tr = table.getElementsByTagName("tr");

  for (let i = 0; i < tr.length; i++) {
    let td = tr[i].getElementsByTagName("td");
    if (td.length > 0) { // Ensure it's a data row, not a header
      let rowText = tr[i].innerText.toLowerCase();
      if (rowText.includes(filter)) {
        tr[i].style.display = ""; // Show the row
      } else {
        tr[i].style.display = "none"; // Hide the row
      }
    }
  }
}
</script>
